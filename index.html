<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø´Ø¨Ø§Ø¨ÙŠÙƒ Ù„Ù„Ø³ØªØ§Ø¦Ø± - Shababek Curtains</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/3y1ZNCk0/1.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root { --gold: #d9b382; --brown: #3d2e24; --bg: #f9f6f2; --white: #ffffff; --whatsapp: #25D366; --red: #ff4d4d; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Cairo', sans-serif; }
        body { background: var(--white); color: var(--brown); line-height: 1.6; }
        
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
        header { background: var(--white); padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .nav-bar { background: #fcfcfc; border-bottom: 1px solid #eee; padding: 10px 0; overflow-x: auto; white-space: nowrap; }
        .nav-menu { display: inline-flex; gap: 20px; list-style: none; padding: 0 20px; }
        .nav-menu a { text-decoration: none; color: var(--brown); font-weight: 700; cursor: pointer; }
        
        .page { display: none; padding: 20px 5%; animation: fadeIn 0.4s ease; }
        .active { display: block !important; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø±ÙØ¹ */
        .admin-box { background: #f4f4f4; padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; border-radius: 10px; border: 1px solid #ddd; }
        .upload-area { background: white; padding: 15px; border: 2px dashed var(--gold); border-radius: 10px; text-align: center; margin-bottom: 10px; }
        .btn-gold { background: var(--gold); color: white; border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-weight: bold; width: 100%; }
        
        /* Ù‚Ø³Ù… Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯ */
        .ba-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .ba-item { position: relative; border-radius: 15px; overflow: hidden; }
        .ba-label { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 2px 10px; border-radius: 5px; font-size: 0.8rem; }

        /* ØªØ¹Ù„Ù… Ù…Ø¹Ù†Ø§ */
        .post-card { background: white; border-radius: 20px; padding: 20px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .post-content { margin: 15px 0; white-space: pre-wrap; }
        .interactions { display: flex; gap: 20px; margin: 15px 0; border-top: 1px solid #eee; padding-top: 10px; }
        .int-btn { cursor: pointer; color: #666; transition: 0.3s; }
        .int-btn:hover { color: var(--gold); }
        .comment-box { background: #f9f9f9; padding: 10px; border-radius: 10px; margin-top: 10px; }
    </style>
</head>
<body>

    <header>
        <div style="font-weight:900; line-height:1;">Ø´Ø¨Ø§Ø¨ÙŠÙƒ<br><span style="color:var(--gold);">Ù„Ù„Ø³ØªØ§Ø¦Ø±</span></div>
        <div onclick="handleLogoClick()" style="cursor:pointer;"><img src="https://i.ibb.co/3y1ZNCk0/1.png" height="60"></div>
        <div class="cart-icon" onclick="showPage('cartPage')"><i class="fas fa-shopping-basket"></i> <span id="cartCount">0</span></div>
    </header>

    <div class="nav-bar">
        <ul class="nav-menu">
            <li><a onclick="showPage('homePage')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
            <li><a onclick="showPage('learnPage')">ØªØ¹Ù„Ù… Ù…Ø¹Ù†Ø§</a></li>
            <li><a onclick="showPage('baPage')">Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯</a></li>
            <li><a onclick="showPage('aboutPage')">Ù…Ù† Ù†Ø­Ù†</a></li>
        </ul>
    </div>

    <main id="mainContainer">
        <div id="homePage" class="page active">
            <h2 style="text-align:center; margin-bottom:20px;">Ø£Ù‚Ø³Ø§Ù…Ù†Ø§</h2>
            <div id="categoriesList" style="display:grid; grid-template-columns:1fr 1fr; gap:15px;"></div>
        </div>

        <div id="learnPage" class="page">
            <h2 style="text-align:center; margin-bottom:20px;">Ù…Ø¯ÙˆÙ†Ø© Ø´Ø¨Ø§Ø¨ÙŠÙƒ ğŸ“š</h2>
            <div id="postsContainer"></div>
        </div>

        <div id="baPage" class="page">
            <h2 style="text-align:center; margin-bottom:20px;">Ù†ØªØ§Ø¦Ø¬Ù†Ø§ (Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯) âœ¨</h2>
            <div id="baContainer"></div>
        </div>

        <div id="adminPanel" class="page">
            <h2 style="text-align:center; margin-bottom:30px;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ</h2>
            
            <div class="admin-box">
                <h3>Ù¡. Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ù…Ù†ØªØ¬Ø§Øª</h3>
                <input type="text" id="admCatName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…">
                <div class="upload-area">
                    <input type="file" id="admCatFile" accept="image/*">
                    <p>Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø§Ù„Ù‚Ø³Ù…</p>
                </div>
                <button class="btn-gold" onclick="uploadAndSave('categories', 'admCatFile', {name:v('admCatName')})">Ø­ÙØ¸ Ø§Ù„Ù‚Ø³Ù…</button>
            </div>

            <div class="admin-box">
                <h3>Ù¢. Ù†Ø´Ø± ÙÙŠ "ØªØ¹Ù„Ù… Ù…Ø¹Ù†Ø§"</h3>
                <input type="text" id="postTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹">
                <textarea id="postText" placeholder="Ø§ÙƒØªØ¨ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ù‡Ù†Ø§..." rows="5"></textarea>
                <div class="upload-area">
                    <input type="file" id="postFile" accept="image/*,video/*">
                    <p>Ø§Ø±ÙÙ‚ ØµÙˆØ±Ø© Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ</p>
                </div>
                <button class="btn-gold" onclick="uploadAndSave('posts', 'postFile', {title:v('postTitle'), content:v('postText'), date:new Date().toLocaleDateString()})">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
            </div>

            <div class="admin-box">
                <h3>Ù£. Ø¥Ø¶Ø§ÙØ© "Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯"</h3>
                <div class="ba-container">
                    <div class="upload-area"><input type="file" id="fileBefore"> <p>ØµÙˆØ±Ø© Ù‚Ø¨Ù„</p></div>
                    <div class="upload-area"><input type="file" id="fileAfter"> <p>ØµÙˆØ±Ø© Ø¨Ø¹Ø¯</p></div>
                </div>
                <button class="btn-gold" onclick="uploadBA()">Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
            </div>
        </div>
    </main>

    <script>
        // --- ØªÙ‡ÙŠØ¦Ø© Firebase ---
        const firebaseConfig = {
            apiKey: "AIzaSyD1TENeV6RkWmrYIjV6seGx84VavsM_tvE",
            authDomain: "shababekcurtain.firebaseapp.com",
            databaseURL: "https://shababekcurtain-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "shababekcurtain",
            storageBucket: "shababekcurtain.appspot.com", // Ø¶Ø±ÙˆØ±ÙŠ Ù„Ù„Ø±ÙØ¹
            messagingSenderId: "1036491730707",
            appId: "1:1036491730707:web:8e364e5264b97f0a8c2797"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const storage = firebase.storage();

        function v(id) { return document.getElementById(id).value; }
        function showPage(id) { document.querySelectorAll('.page').forEach(p => p.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0,0); }
        
        let adminClicks = 0;
        function handleLogoClick() { adminClicks++; if(adminClicks >= 5) { if(prompt("Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:")==="8496") showPage('adminPanel'); adminClicks=0; } }

        // --- Ø¯Ø§Ù„Ø© Ø§Ù„Ø±ÙØ¹ Ø§Ù„Ø³Ø­Ø±ÙŠØ© (Firebase Storage) ---
        async function uploadFile(file) {
            if(!file) return null;
            const ref = storage.ref('shababek_uploads/' + Date.now() + '_' + file.name);
            const snapshot = await ref.put(file);
            return await snapshot.ref.getDownloadURL();
        }

        async function uploadAndSave(path, fileId, dataObj) {
            const file = document.getElementById(fileId).files[0];
            try {
                alert("Ø¨Ø¯Ø£ Ø§Ù„Ø±ÙØ¹... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±");
                const url = await uploadFile(file);
                dataObj.mediaUrl = url;
                await db.ref(path).push(dataObj);
                alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!");
                location.reload();
            } catch(e) { alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±ÙØ¹: " + e.message); }
        }

        async function uploadBA() {
            const b = document.getElementById('fileBefore').files[0];
            const a = document.getElementById('fileAfter').files[0];
            if(!b || !a) return alert("Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±ØªÙŠÙ†");
            alert("ÙŠØ±ÙØ¹ Ø§Ù„Ø¢Ù†...");
            const urlB = await uploadFile(b);
            const urlA = await uploadFile(a);
            await db.ref('beforeAfter').push({ before: urlB, after: urlA });
            alert("ØªÙ… Ø§Ù„Ø­ÙØ¸!");
            location.reload();
        }

        // --- Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
        db.ref('categories').on('value', snap => {
            const data = snap.val() || {};
            document.getElementById('categoriesList').innerHTML = Object.values(data).map(c => `
                <div style="background:white; border-radius:15px; overflow:hidden; box-shadow:0 4px 10px rgba(0,0,0,0.1);">
                    <img src="${c.mediaUrl}" style="width:100%; height:150px; object-fit:cover;">
                    <p style="text-align:center; padding:10px; font-weight:bold;">${c.name}</p>
                </div>
            `).join('');
        });

        db.ref('posts').on('value', snap => {
            const data = snap.val() || {};
            document.getElementById('postsContainer').innerHTML = Object.entries(data).reverse().map(([id, p]) => `
                <div class="post-card">
                    <h3>${p.title}</h3>
                    <small>${p.date}</small>
                    ${p.mediaUrl ? `<img src="${p.mediaUrl}" style="width:100%; border-radius:15px; margin-top:10px;">` : ''}
                    <div class="post-content">${p.content}</div>
                    <div class="interactions">
                        <span class="int-btn" onclick="like('${id}')"><i class="far fa-heart"></i> Ø£Ø­Ø¨Ø¨Øª (${p.likes || 0})</span>
                        <span class="int-btn" onclick="comment('${id}')"><i class="far fa-comment"></i> ØªØ¹Ù„ÙŠÙ‚</span>
                    </div>
                </div>
            `).join('');
        });

        db.ref('beforeAfter').on('value', snap => {
            const data = snap.val() || {};
            document.getElementById('baContainer').innerHTML = Object.values(data).reverse().map(i => `
                <div class="ba-container" style="background:#eee; padding:10px; border-radius:20px; margin-bottom:20px;">
                    <div class="ba-item"><span class="ba-label">Ù‚Ø¨Ù„</span><img src="${i.before}" style="width:100%;"></div>
                    <div class="ba-item"><span class="ba-label">Ø¨Ø¹Ø¯</span><img src="${i.after}" style="width:100%;"></div>
                </div>
            `).join('');
        });

        function like(id) {
            const ref = db.ref('posts/' + id + '/likes');
            ref.transaction(cur => (cur || 0) + 1);
            confetti({particleCount: 50, spread: 60});
        }
    </script>
</body>
</html>
