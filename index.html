<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ุดุจุงุจูู ููุณุชุงุฆุฑ - Shababek Curtains</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/3y1ZNCk0/1.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    /* ุชูุณูู ูููุน ุงูุชูุฑูุฑ ุงูุฌุงูุจู ููุฌุนู ุงูุฌุฏูู ูุชูุงุณูุงู ุนูู ุงููุชุตูุญ */
.admin-table {
    width: 100%;
    table-layout: fixed; /* ูููุน ุงูุฌุฏูู ูู ุงูุฎุฑูุฌ ุนู ุญุฏูุฏ ุงูุดุงุดุฉ */
}

.admin-table img {
    width: 70px;         /* ุญุฌู ุตุบูุฑ ูููุธู ููุตูุฑ ุฏุงุฎู ุงูุฌุฏูู */
    height: 70px;
    object-fit: cover;   /* ูุถูุงู ุนุฏู ุชูุทูุท ุงูุตูุฑุฉ */
    border-radius: 5px;
}

.admin-table td {
    word-wrap: break-word; /* ููุณุฑ ุงููุตูุต ุงูุทูููุฉ ูููุน ุชูุฏุฏ ุงูุฌุฏูู */
}: 20px; padding: 15px; display: none; }
    </style>
</head>
<body>

    <div class="top-banner">
        <span>ุดุจุงุจูู ููุณุชุงุฆุฑ - ุธู ูุฐูู</span>
        <a href="https://wa.me/9647883002797" class="wa-link"><i class="fab fa-whatsapp"></i> ุชูุงุตู ุนุจุฑ ุงููุงุชุณุงุจ</a>
    </div>

    <header>
        <div style="font-weight:900; line-height:1; flex:1;">ุดุจุงุจูู<br><span style="color:var(--gold); font-size:1rem;">ููุณุชุงุฆุฑ</span></div>
        <div class="logo-center" onclick="handleLogoClick()"><img src="https://i.ibb.co/3y1ZNCk0/1.png" class="logo-img"></div>
        <div class="header-left">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="ุงุจุญุซ ุนู ููุฏูู.." onkeyup="handleSearch()">
            </div>
            <div class="cart-icon" onclick="toggleCartModal()">
                <i class="fas fa-shopping-basket"></i>
                <span id="globalCartCount" class="cart-count">0</span>
            </div>
        </div>
    </header>
    
    <div id="searchRes"></div>

    <div class="nav-bar">
        <ul class="nav-menu">
            <li><a onclick="showPage('homePage')">ุงูุฑุฆูุณูุฉ</a></li>
            <li><a onclick="showPage('homePage'); setTimeout(() => { document.getElementById('categories').scrollIntoView({behavior: 'smooth'}); }, 100);">ุงูููุชุฌุงุช</a></li>
            <li><a onclick="showPage('doctorPage')">ุฏูุชูุฑ ุฏูููุฑ</a></li>
            <li><a onclick="showPage('paymentPage')">ุทุฑู ุงูุฏูุน</a></li>
            <li><a onclick="showPage('aboutPage')">ูู ูุญู</a></li>
            <li><a onclick="showPage('contactPage')">ุชูุงุตู ูุนูุง</a></li>
        </ul>
    </div>

    <div id="cartOverlay">
        <div class="cart-modal">
            <h2 style="margin-bottom:20px; border-bottom:2px solid var(--gold); padding-bottom:10px; font-weight:900;">ุณูุฉ ุงููุดุชุฑูุงุช</h2>
            <div id="cartItemsList"></div>
            
            <div id="checkoutFields" style="margin-top:20px; border-top:2px solid var(--gold); padding-top:15px;">
                <label style="font-weight:bold; font-size:0.9rem;">ุงููุญุงูุธุฉ:</label>
                <select id="userCity">
                    <option value="ุจุบุฏุงุฏ">ุจุบุฏุงุฏ</option><option value="ุงูุจุตุฑุฉ">ุงูุจุตุฑุฉ</option><option value="ููููู">ููููู</option><option value="ุฃุฑุจูู">ุฃุฑุจูู</option><option value="ุงููุฌู">ุงููุฌู</option><option value="ูุฑุจูุงุก">ูุฑุจูุงุก</option><option value="ุจุงุจู">ุจุงุจู</option><option value="ุงูุฃูุจุงุฑ">ุงูุฃูุจุงุฑ</option><option value="ุฐู ูุงุฑ">ุฐู ูุงุฑ</option><option value="ุฏูุงูู">ุฏูุงูู</option><option value="ููุณุงู">ููุณุงู</option><option value="ูุงุณุท">ูุงุณุท</option><option value="ุงููุซูู">ุงููุซูู</option><option value="ูุฑููู">ูุฑููู</option><option value="ุตูุงุญ ุงูุฏูู">ุตูุงุญ ุงูุฏูู</option><option value="ุฏููู">ุฏููู</option><option value="ุงูุณูููุงููุฉ">ุงูุณูููุงููุฉ</option><option value="ุงููุงุฏุณูุฉ">ุงููุงุฏุณูุฉ</option>
                </select>
                <label style="font-weight:bold; font-size:0.9rem; margin-top:10px; display:block;">ุทุฑููุฉ ุงูุฏูุน:</label>
                <select id="userPayment">
                    <option value="ููุฏ ุนูุฏ ุงูุงุณุชูุงู">ููุฏ ุนูุฏ ุงูุงุณุชูุงู</option><option value="ุฒูู ูุงุด">ุฒูู ูุงุด</option><option value="ูู ูุงุฑุฏ">ูู ูุงุฑุฏ / ููุฒุง</option>
                </select>
            </div>

            <div style="margin-top:20px;">
                <button class="btn-gold" style="width:100%; padding:20px;" onclick="sendOrder()">ุฅุฑุณุงู ุงูุทูุจ ุนุจุฑ ูุงุชุณุงุจ</button>
                <p onclick="toggleCartModal()" style="margin-top:20px; text-align:center; color:#999; cursor:pointer; font-weight:bold;">ุฅุบูุงู</p>
            </div>
        </div>
    </div>

    <main id="mainContainer">
        <div id="homePage" class="page active">
            <section class="hero">
                <h1>ูุฎุงูุฉ ุงูุชูุงุตูู ุชุจุฏุฃ ูู ุดุจุงุจูู ููุฒูู</h1>
                <div class="hero-btns">
                    <button onclick="document.getElementById('categories').scrollIntoView()" class="btn-gold">ุงุญุณุจ ุณุนุฑ ุณุชุงุฆุฑู ุงูุขู</button>
                    <a href="https://wa.me/9647883002797" class="btn-trans"><i class="fab fa-whatsapp"></i> ุงุณุชุดุงุฑุฉ ูุฌุงููุฉ</a>
                </div>
                <div class="social-hero">
                    <a href="https://www.facebook.com/profile.php?id=61587692021311" target="_blank"><i class="fab fa-facebook"></i></a>
                    <a href="https://www.instagram.com/shababek.curtains/" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.tiktok.com/@shababek.curtains" target="_blank"><i class="fab fa-tiktok"></i></a>
                    <a href="https://youtube.com/@shababek.curtains?si=KKsEbL98N0fq2e2U" target="_blank"><i class="fab fa-youtube"></i></a>
                    <a href="https://x.com/ShababekCurtain" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.snapchat.com/add/shababekcurtin?share_id=B2Prmbx5_Xo&locale=en-IQ" target="_blank"><i class="fab fa-snapchat"></i></a>
                </div>
            </section>
            <section id="categories" style="padding: 40px 0;">
                <h2 style="text-align:center; font-weight:900; margin-bottom:15px;">ุฃูุณุงููุง ุงููููุฒุฉ</h2>
                <div id="categoriesList" style="display:flex; overflow-x:auto; gap:20px; padding:20px 5%; scrollbar-width:none;"></div>
            </section>
            <section class="features-section">
                <h2 style="margin-bottom:35px; font-weight:900;">ููุงุฐุง ุดุจุงุจููุ</h2>
                <div class="features-grid">
                    <div class="f-card"><i class="fa-solid fa-shield-halved" style="color:var(--gold); font-size:2.2rem; margin-bottom:10px;"></i><h3>ุถูุงู ุญูููู</h3><p>ุฃุฑูู ุงูุฃููุดุฉ ุจุถูุงู ุฑุณูู.</p></div>
                    <div class="f-card"><i class="fa-solid fa-truck-fast" style="color:var(--gold); font-size:2.2rem; margin-bottom:10px;"></i><h3>ููุงุณ ููุฒูู</h3><p>ูุตููู ููููุงุณ ูุฌุงูุงู.</p></div>
                    <div class="f-card"><i class="fa-solid fa-ruler-combined" style="color:var(--gold); font-size:2.2rem; margin-bottom:10px;"></i><h3>ุชูุตูู ุฏููู</h3><p>ุฎูุงุทุฉ ุงุญุชุฑุงููุฉ ุญุณุจ ุงูุทูุจ.</p></div>
                    <div class="f-card"><i class="fa-solid fa-palette" style="color:var(--gold); font-size:2.2rem; margin-bottom:10px;"></i><h3>ุฐูู ุฑููุน</h3><p>ุฃุญุฏุซ ุงูููุฏููุงุช ุงูุนุตุฑูุฉ.</p></div>
                </div>
            </section>
        </div>

        <div id="doctorPage" class="page">
            <div style="padding: 40px 5%; max-width: 800px; margin: auto;">
                <h2 style="text-align:center; font-weight:900; margin-bottom:30px;">ุฏูุชูุฑ ุฏูููุฑ </h2>
                <div id="docSectionsNav" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap:15px; margin-bottom:30px;"></div>
            </div>
        </div>

        <div id="docInsidePage" class="page">
            <div style="padding: 40px 5%; max-width: 600px; margin: auto;">
                <h2 id="currentDocTitle" style="text-align:center; margin-bottom:30px; color:var(--gold);"></h2>
                <div id="docTopicsList"></div>
                <button onclick="showPage('doctorPage')" class="btn-gold" style="width:100%; margin-top:20px; background:var(--brown);">ุงูุนูุฏุฉ</button>
            </div>
        </div>

        <div id="adminPanel" class="page">
            <div style="padding: 40px 5%; max-width: 900px; margin: auto;">
                <h2 style="text-align:center; margin-bottom:40px; font-weight:900;">ููุญุฉ ุงูุฅุฏุงุฑุฉ ุงูุณุญุงุจูุฉ</h2>
                <div class="admin-box">
                    <h3>ูก. ุฅุฏุงุฑุฉ ุงูุฃูุณุงู</h3>
                    <input type="text" id="admCatName" placeholder="ุงุณู ุงููุณู">
                   <input type="file" id="admCatFile" accept="image/*" style="margin: 10px 0; width: 100%;">
<button onclick="publishCat()" class="btn-gold">ุญูุธ ุงููุณู</button>

                    <table class="admin-table"><tbody id="admListCats"></tbody></table>
                </div>
                <div class="admin-box">
                    <h3>ูข. ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</h3>
                   <select id="selectDocTopicSec"></select>
                    <input type="text" id="admProdName" placeholder="ุงุณู ุงูููุฏูู">
                    <input type="number" id="admProdPrice" placeholder="ุงูุณุนุฑ">
                    <input type="text" id="admProdImg" placeholder="ุฑุงุจุท ุงูุตูุฑุฉ">
                    <button onclick="saveItem('products', {category:v('admProdCatSelect'), name:v('admProdName'), price:v('admProdPrice'), img:v('admProdImg')})" class="btn-gold">ูุดุฑ</button>
                    <table class="admin-table"><tbody id="admListProds"></tbody></table>
                </div>
                <div class="admin-box" style="border:2px solid var(--gold);">
                    <h3>ูฃ. ุฅุฏุงุฑุฉ ุฏูุชูุฑ ุฏูููุฑ</h3>
                    <input type="text" id="admDocSecName" placeholder="ุงุณู ุงููุณู ุงููุฑุนู">
                    <button onclick="saveItem('docSections', {name:v('admDocSecName')})" class="btn-gold">ุฅุถุงูุฉ ูุณู</button>
                    <table class="admin-table"><tbody id="admListDocSecs"></tbody></table>
                    <hr>
                    <select id="selectDocTopicSec"></select>
                    <input type="text" id="admDocTitle" placeholder="ุงูุนููุงู">
                    <textarea id="admDocDesc" placeholder="ุงูุดุฑุญ"></textarea>
                    <input type="text" id="admDocMedia" placeholder="ุฑุงุจุท ููุฏูุง">
                    <select id="admDocType"><option value="img">ุตูุฑุฉ</option><option value="vid">ููุชููุจ ุนุงุฏู</option><option value="shorts">ููุชููุจ ุดูุฑุชุณ</option></select>
                    <select id="admDocMode"><option value="closed">ููุงูุฉ (ุจุงูุถุบุท)</option><option value="open">ูุจุงุดุฑ (ุณูุฑูู)</option></select>
                    <button onclick="saveItem('docTopics', {section:v('admDocTopicSec'), title:v('admDocTitle'), desc:v('admDocDesc'), media:v('admDocMedia'), type:v('admDocType'), mode:v('admDocMode')})" class="btn-gold">ูุดุฑ</button>
                    <table class="admin-table"><tbody id="admListDocTopics"></tbody></table>
                </div>
                <div class="admin-box">
                    <h3>ูค. ุทุฑู ุงูุฏูุน</h3>
                    <input type="text" id="admPayName" placeholder="ุงุณู ุงูุทุฑููุฉ">
                    <input type="text" id="admPayQR" placeholder="ุฑุงุจุท ุงูุจุงุฑููุฏ">
                    <button onclick="saveItem('payments', {name:v('admPayName'), qr:v('admPayQR')})" class="btn-gold">ุญูุธ</button>
                    <table class="admin-table"><tbody id="admListPays"></tbody></table>
                </div>
            </div>
        </div>

        <div id="aboutPage" class="page"><div style="padding: 60px 5%; max-width: 1100px; margin: auto;"><h2 style="font-weight:900; font-size:2.5rem; margin-bottom:30px; text-align:center;">ุดุจุงุจูู ููุณุชุงุฆุฑ</h2><p style="font-size:1.2rem; line-height:2.2; color:#444; text-align:justify;">ุชุฃุณุณุช ุดุจุงุจูู ููุณุชุงุฆุฑ ุจูุฏู ุชูุฏูู ุฃูุฎู ูุฃุฌูุฏ ุฃููุงุน ุงูุณุชุงุฆุฑ ุงูููุฒููุฉ ูู ุงูุนุฑุงู. ูุคูู ุจุฃู ุงูุณุชุงุฆุฑ ููุณุช ูุฌุฑุฏ ูุทุนุฉ ููุงุดุ ุจู ูู ุนูุตุฑ ุฃุณุงุณู ูู ุชุตููู ุงูููุฒู ูุนูุณ ุฐูู ุฃุตุญุงุจู ููุถูู ููุณุฉ ูู ุงูุฃูุงูุฉ ูุงููุฎุงูุฉ.

ููุฏู ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุณุชุงุฆุฑ ุชุดูู ุงูุจูุงู ุฃูุช ูุงูุดูุงูุฉ ูุงูุฏูููุฑูุฉ ูุณุชุงุฆุฑ ุงูุฑููุ ุจุฃููุดุฉ ูุณุชูุฑุฏุฉ ูู ุฃูุถู ุงููุตุงูุน ุงูุนุงูููุฉ. ููุง ูููุฑ ุฎุฏูุฉ ุงูุชูุตูู ุญุณุจ ุงูููุงุณุงุช ูุฎุฏูุฉ ุงูุชุฑููุจ ุงูููุฒูู ุจุฃูุฏู ููููู ูุชุฎุตุตูู.

ุฑุคูุชูุง ูู ุฃู ูููู ุงููุฌูุฉ ุงูุฃููู ููุณุชุงุฆุฑ ุงููุงุฎุฑุฉ ูู ุงูุนุฑุงูุ ููุณุนู ุฏุงุฆูุงู ูุชุญููู ุฑุถุง ุนููุงุฆูุง ูู ุฎูุงู ุงูุฌูุฏุฉ ุงูุนุงููุฉ ูุงูุฃุณุนุงุฑ ุงูููุงูุณุฉ ูุงูุฎุฏูุฉ ุงููุชููุฒุฉ....</p><div class="stat-grid"><div class="stat-card"><span class="stat-num">500+</span><p>ุนููู ุณุนูุฏ</p></div><div class="stat-card"><span class="stat-num">50+</span><p>ุชุตููู ุญุตุฑู</p></div><div class="stat-card"><span class="stat-num">10+</span><p>ุณููุงุช ุฎุจุฑุฉ</p></div></div></div></div>
        <div id="contactPage" class="page"><div style="padding: 60px 5%; text-align: center; background: var(--bg); border-radius: 40px; margin: 40px 5%;"><h2 style="margin-bottom:30px; font-weight: 900; font-size: 2.2rem;">ุชูุงุตู ูุนูุง</h2><div><i class="fa-solid fa-phone"></i> 07883002797</div><div style="margin-top:10px;"><i class="fa-solid fa-location-dot"></i> ุงูุนุฑุงู - ุจุบุฏุงุฏ</div><a href="https://wa.me/9647883002797" class="btn-gold" style="display:inline-block; text-decoration:none; margin-top:20px;">ูุฑุงุณูุฉ ูุงุชุณุงุจ ูุจุงุดุฑ</a></div></div>
        <div id="categoryView" class="page"><h2 id="catTitle" style="text-align:center; padding:40px 0; font-weight:900;"></h2><div id="catGrid" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap:25px; padding:0 5%;"></div></div>
        <div id="productCalculator" class="page"><div style="padding:40px 5%; max-width:650px; margin:auto; text-align:center;"><img id="pImg" src="" style="width:100%; border-radius:25px; margin-bottom:25px;"><h2 id="pName"></h2><div style="color:var(--gold); font-size:1.8rem; font-weight:900; margin-bottom:30px;"><span id="pPrice"></span> ุฏ.ุน / ูุชุฑ</div><input type="number" id="hIn" placeholder="ุฃุฏุฎู ุงูุทูู ุจุงููุชุฑ" style="text-align:center;"><button onclick="addToCart()" class="btn-gold" style="width:100%;">ุฅุถุงูุฉ ููุณูุฉ</button><button onclick="toggleCartModal()" style="background:transparent; border:2px solid var(--gold); color:var(--gold); width:100%; padding:18px; border-radius:12px; margin-top:10px;">ุฅุชูุงู ุงูุทูุจ ุงูุขู</button></div></div>
        <div id="paymentPage" class="page"><div id="paymentList" style="padding: 40px 5%; max-width: 850px; margin: auto;"></div></div>
    </main>

    <div class="footer-cta">
        <h2>ุฌุงูุฒ ูุชุฌุฏูุฏ ุณุชุงุฆุฑ ููุฒููุ</h2>
        <div style="display:flex; justify-content:center; flex-wrap:wrap; gap:10px;">
            <a href="https://wa.me/9647883002797" class="btn-footer-wa">ุชูุงุตู ุนุจุฑ ูุงุชุณุงุจ</a>
            <a onclick="showPage('homePage'); document.getElementById('categories').scrollIntoView()" class="btn-footer-prod">ุชุตูุญ ุงูููุชุฌุงุช</a>
        </div>
    </div>

    <footer><div style="font-size:1.8rem; font-weight:900; color:var(--gold); margin-bottom:10px;">ุดุจุงุจูู</div><p>ยฉ 2026 ุฌููุน ุงูุญููู ูุญููุธุฉ ูุดุจุงุจูู ููุณุชุงุฆุฑ - ุธู ูุฐูู</p></footer>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyD1TENeV6RkWmrYIjV6seGx84VavsM_tvE", authDomain: "shababekcurtain.firebaseapp.com", databaseURL: "https://shababekcurtain-default-rtdb.asia-southeast1.firebasedatabase.app/", projectId: "shababekcurtain" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let cur = null, cart = [], adminClicks = 0, globalDocTopics = {};

        function v(id) { return document.getElementById(id).value; }
        function showPage(id, push = true) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo(0,0);
            if(push) history.pushState({pageId: id}, null, "");
        }
        window.onpopstate = e => showPage(e.state ? e.state.pageId : 'homePage', false);
        function handleLogoClick() { adminClicks++; if(adminClicks >= 5) { if(prompt("ุงูุฑูุฒ:") === "8496") showPage('adminPanel'); adminClicks = 0; } else { showPage('homePage'); } }
        function saveItem(ref, obj) { db.ref(ref).push(obj).then(() => { alert("ุชู ุงูุญูุธ!"); location.reload(); }); }
        function deleteItem(ref, key) { if(confirm("ุญุฐูุ")) db.ref(ref).child(key).remove(); }

        function extractYoutubeId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|shorts\/)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        // ูุฒุงููุฉ ููุญุฉ ุงูุชุญูู (ุชู ูุตู ุงุฎุชูุงุฑ ุงูุฃูุณุงู ุจุฏูุฉ)
        db.ref('categories').on('value', snap => {
            const cats = snap.val() || {};
            document.getElementById('categoriesList').innerHTML = Object.values(cats).map(c => `<div onclick="openCat('${c.name}')" style="flex:0 0 250px;height:350px;position:relative;border-radius:20px;overflow:hidden;cursor:pointer;"><img src="${c.img}" style="width:100%;height:100%;object-fit:cover;"><div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:var(--gold);color:white;padding:10px 25px;border-radius:12px;font-weight:900;">${c.name}</div></div>`).join('');
            document.getElementById('admListCats').innerHTML = Object.entries(cats).map(([k,v]) => `<tr><td>${v.name}</td><td><button onclick="deleteItem('categories','${k}')" style="color:red; font-weight:bold; border:none; background:none;">ุญุฐู</button></td></tr>`).join('');
            document.getElementById('admProdCatSelect').innerHTML = '<option disabled selected>ุงุฎุชุฑ ูุณู ุงูููุชุฌุงุช</option>' + Object.values(cats).map(s => `<option>${s.name}</option>`).join('');
        });

        db.ref('products').on('value', snap => {
            const data = snap.val() || {};
            document.getElementById('admListProds').innerHTML = Object.entries(data).map(([k,v]) => `<tr><td>${v.name}</td><td><button onclick="deleteItem('products','${k}')" style="color:red; font-weight:bold; border:none; background:none;">ุญุฐู</button></td></tr>`).join('');
        });

      // ูุฒุงููุฉ ุฃูุณุงู ุฏูุชูุฑ ุฏูููุฑ ูุชุนุจุฆุฉ ููุงุฆู ุงูุงุฎุชูุงุฑ ูู ููุญุฉ ุงูุชุญูู
        db.ref('docSections').on('value', snap => {
            const data = snap.val() || {};
            
            // ุชุญุฏูุซ ุงูุฃูุณุงู ูู ุตูุญุฉ ุฏูุชูุฑ ุฏูููุฑ (ุงููุธูุฑ ุงูุจูู)
            document.getElementById('docSectionsNav').innerHTML = Object.values(data).map(s => `
                <div onclick="openDocInside('${s.name}')" style="background:var(--brown);color:white;padding:20px;border-radius:15px;text-align:center;cursor:pointer;font-weight:900;">
                    ${s.name}
                </div>`).join('');
            
            // ุชุญุฏูุซ ุฌุฏูู ุญุฐู ุงูุฃูุณุงู ูู ููุญุฉ ุงูุชุญูู
            document.getElementById('admListDocSecs').innerHTML = Object.entries(data).map(([k,v]) => `
                <tr>
                    <td>${v.name}</td>
                    <td><button onclick="deleteItem('docSections','${k}')" style="color:red; font-weight:bold; border:none; background:none; cursor:pointer;">ุญุฐู</button></td>
                </tr>`).join('');
            
            // ุชุนุจุฆุฉ ุงููุงุฆูุฉ ุงูููุณุฏูุฉ (ุงูุฏุฑูุจ ุฏุงูู) ููู ุชุธูุฑ ุงูุฃูุณุงู ูุชุณุชุทูุน ูุดุฑ ุงูููุงุถูุน
            document.getElementById('admDocTopicSec').innerHTML = '<option disabled selected>ุงุฎุชุฑ ูุณู ุฏูุชูุฑ ุฏูููุฑ</option>' + 
                Object.values(data).map(s => `<option value="${s.name}">${s.name}</option>`).join('');
        });

        // ูุฒุงููุฉ ููุงุถูุน ุฏูุชูุฑ ุฏูููุฑ (ุงูููุงูุงุช ูุงูุฑููุฒ) ูุฌุฏูู ุงูุญุฐู
        db.ref('docTopics').on('value', snap => {
            globalDocTopics = snap.val() || {};
            
            // ุชุญุฏูุซ ุฌุฏูู ุญุฐู ุงูููุงุถูุน ูู ููุญุฉ ุงูุชุญูู
            document.getElementById('admListDocTopics').innerHTML = Object.entries(globalDocTopics).map(([k,v]) => `
                <tr>
                    <td>${v.title}</td>
                    <td><button onclick="deleteItem('docTopics','${k}')" style="color:red; font-weight:bold; border:none; background:none; cursor:pointer;">ุญุฐู</button></td>
                </tr>`).join('');
        });

        db.ref('payments').on('value', snap => {
            const data = snap.val() || {};
            document.getElementById('admListPays').innerHTML = Object.entries(data).map(([k,v]) => `<tr><td>${v.name}</td><td><button onclick="deleteItem('payments','${k}')" style="color:red; font-weight:bold; border:none; background:none;">ุญุฐู</button></td></tr>`).join('');
            document.getElementById('paymentList').innerHTML = Object.values(data).map(p => `<div style="text-align:center;margin-bottom:30px;"><h3>${p.name}</h3><img src="${p.qr}" style="width:280px;border-radius:20px;"></div>`).join('');
        });

        function openDocInside(secName) {
            document.getElementById('currentDocTitle').innerText = secName;
            db.ref('docTopics').once('value', snap => {
                const topics = Object.entries(snap.val() || {}).filter(([k,v]) => v.section === secName);
                document.getElementById('docTopicsList').innerHTML = topics.map(([k,v]) => {
                    let media = "";
                    const id = extractYoutubeId(v.media);
                    if(v.type === 'shorts') media = `<div class="reel-container"><iframe class="auto-video" src="https://www.youtube.com/embed/${id}?enablejsapi=1&autoplay=1&mute=1&playlist=${id}&loop=1&controls=1" frameborder="0" allow="autoplay; encrypted-media"></iframe></div>`;
                    else if(v.type === 'vid') media = `<div class="vid-frame-wide"><iframe src="https://www.youtube.com/embed/${id}?controls=1" frameborder="0" allowfullscreen></iframe></div>`;
                    else media = `<img src="${v.media}" style="width:100%; border-radius:20px; margin-bottom:15px;">`;
                    const isDirect = v.mode === 'open';
                    return `<div style="background:white; border-radius:25px; overflow:hidden; margin-bottom:20px; border:1px solid #eee; padding:20px;">
                        <h3 onclick="${isDirect ? '' : "this.nextElementSibling.style.display='block'"}" style="cursor:pointer; color:var(--brown); font-weight:900;">${v.title}</h3>
                        <div style="display:${isDirect ? 'block' : 'none'}; margin-top:15px;">${media}<p>${v.desc}</p></div>
                    </div>`;
                }).join('');
                initObserver();
                showPage('docInsidePage');
            });
        }

        function initObserver() {
            const obs = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const iframe = entry.target;
                    if(iframe.contentWindow) iframe.contentWindow.postMessage(`{"event":"command","func":"${entry.isIntersecting ? 'playVideo' : 'pauseVideo'}","args":""}`, '*');
                });
            }, { threshold: 0.6 });
            document.querySelectorAll('.auto-video').forEach(v => obs.observe(v));
        }

        function addToCart() { const h = v('hIn'); if(!h || h<=0) return alert("ุฃุฏุฎู ุงูุทูู"); cart.push({n: cur.name, p: Math.round(h*cur.price).toLocaleString()}); document.getElementById('globalCartCount').innerText = cart.length; confetti({particleCount:150, spread:70, origin:{y:0.6}}); alert("ุชูุช ุงูุฅุถุงูุฉ!"); }
        function toggleCartModal() { const o = document.getElementById('cartOverlay'); o.style.display = o.style.display === 'flex' ? 'none' : 'flex'; const list = document.getElementById('cartItemsList'); list.innerHTML = cart.map(i => `<div class="cart-item"><span>${i.n}</span><b>${i.p} ุฏ.ุน</b></div>`).join(''); }
        
        function sendOrder() {
            if(cart.length === 0) return alert("ุงูุณูุฉ ูุงุฑุบุฉ");
            const city = document.getElementById('userCity').value;
            const pay = document.getElementById('userPayment').value;
            let msg = `ุทูุจ ุฌุฏูุฏ ูู ุดุจุงุจูู ๐ช\n๐ ุงููุญุงูุธุฉ: ${city}\n๐ฐ ุงูุฏูุน: ${pay}\n๐ฆ ุงูููุชุฌุงุช:\n`;
            cart.forEach((i, x) => msg += `${x+1}- ${i.n}: ${i.p} ุฏ.ุน\n`);
            window.location.href = `https://wa.me/9647883002797?text=${encodeURIComponent(msg)}`;
            setTimeout(() => { cart = []; document.getElementById('globalCartCount').innerText = "0"; toggleCartModal(); confetti({particleCount:200, spread:100, origin:{y:0.5}, colors:['#d9b382','#3d2e24','#ffffff']}); }, 1000);
        }

        function openCat(n) { db.ref('products').once('value', snap => { const items = Object.values(snap.val() || {}).filter(i => i.category === n); document.getElementById('catTitle').innerText = n; document.getElementById('catGrid').innerHTML = items.map(x => `<div style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 8px 15px rgba(0,0,0,0.05);" onclick='openCalc(${JSON.stringify(x)})'><img src="${x.img}" style="width:100%;height:250px;object-fit:cover;"><div style="padding:20px;text-align:center;"><h3>${x.name}</h3><p style="color:var(--gold);font-weight:900;">${parseInt(x.price).toLocaleString()} ุฏ.ุน</p></div></div>`).join(''); showPage('categoryView'); }); }
        function openCalc(p) { cur = p; document.getElementById('pName').innerText = p.name; document.getElementById('pPrice').innerText = parseInt(p.price).toLocaleString(); document.getElementById('pImg').src = p.img; document.getElementById('hIn').value = ""; showPage('productCalculator'); }
        function handleSearch() {
            const query = v('searchInput').toLowerCase();
            const resBox = document.getElementById('searchRes');
            if(query.length < 2) { resBox.style.display = 'none'; return; }
            db.ref('products').once('value', snap => {
                const data = snap.val() || {};
                const found = Object.values(data).filter(p => p.name.toLowerCase().includes(query));
                resBox.innerHTML = found.map(p => `<div onclick='openCalc(${JSON.stringify(p)}); document.getElementById("searchRes").style.display="none"' style="padding:15px; border-bottom:1px solid #eee; cursor:pointer;">${p.name}</div>`).join('') || '<p style="padding:15px;">ูุง ุชูุฌุฏ ูุชุงุฆุฌ</p>';
                resBox.style.display = 'block';
            });
        }
    // ==========================================
// ูุณู ุงูุฑูุน ุงููุจุงุดุฑ ูุตูุฑ ุดุจุงุจูู (ImgBB)
// ==========================================

const IMGBB_KEY = "8c910c592194477f91663705e636a65c";

// ุฏุงูุฉ ุงูุฑูุน ุงูุฃุณุงุณูุฉ
async function uploadImg(file) {
    if(!file) return "";
    let formData = new FormData();
    formData.append("image", file);
    const res = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`, { 
        method: "POST", 
        body: formData 
    });
    const data = await res.json();
    return data.data.url;
} // ุฅุบูุงู ุฏุงูุฉ uploadImg ุจุงูุณุทุฑ 411

// ุฏุงูุฉ ุญูุธ ุงูุฃูุณุงู ุงููุตูุญุฉ (ุชุนูู ุจุงูุฑูุน ุงููุจุงุดุฑ)
async function publishCat() {
    const fileInput = document.getElementById('admCatFile');
    const nameInput = document.getElementById('admCatName'); 
    
    if(!fileInput.files[0] || !nameInput.value) {
        return alert("ูุฑุฌู ูุชุงุจุฉ ุงุณู ุงููุณู ูุงุฎุชูุงุฑ ุตูุฑุฉ");
    }

    alert("ุฌุงุฑู ุฑูุน ุตูุฑุฉ ุงููุณู... ูุฑุฌู ุงูุงูุชุธุงุฑ");

    try {
        const imageUrl = await uploadImg(fileInput.files[0]);
        // ุงูุญูุธ ูู ูุงุนุฏุฉ ุจูุงูุงุช Firebase
        db.ref('categories').push({
            name: nameInput.value,
            img: imageUrl
        }).then(() => {
            alert("ุชู ุญูุธ ุงููุณู ุจูุฌุงุญ!");
            location.reload();
        });
    } catch (error) {
        console.error(error);
        alert("ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงูุ ุญุงูู ูุฑุฉ ุฃุฎุฑู");
    }
}

// ุฏุงูุฉ ุญูุธ ุงูููุชุฌุงุช ุงููุตูุญุฉ (ูููุฑุญูุฉ ุงููุงุฏูุฉ)
async function publishProd() {
    const fileInput = document.getElementById('admProdFile');
    const nameInput = document.getElementById('admProdName');
    const priceInput = document.getElementById('admProdPrice');
    const catSelect = document.getElementById('admProdCatSelect');

    if(!fileInput.files[0] || !nameInput.value || !priceInput.value) {
        return alert("ูุฑุฌู ุฅููุงู ุจูุงูุงุช ุงูููุชุฌ ูุงุฎุชูุงุฑ ุงูุตูุฑุฉ");
    }

    alert("ุฌุงุฑู ุฑูุน ุตูุฑุฉ ุงูููุชุฌ...");

    try {
        const imageUrl = await uploadImg(fileInput.files[0]);
        db.ref('products').push({
            category: catSelect.value,
            name: nameInput.value,
            price: priceInput.value,
            img: imageUrl
        }).then(() => {
            alert("ุชู ูุดุฑ ุงูููุชุฌ ุจูุฌุงุญ!");
            location.reload();
        });
    } catch (error) {
        alert("ูุดู ุฑูุน ุตูุฑุฉ ุงูููุชุฌ");
    }
}

// ุฏุงูุฉ ุญูุธ ุงูููุชุฌุงุช ุงููุตูุญุฉ (ููู ุชุนูู ุจููุณ ุงูุทุฑููุฉ)
async function publishProd() {
    const fileInput = document.getElementById('admProdFile');
    const nameInput = document.getElementById('admProdName');
    const priceInput = document.getElementById('admProdPrice');
    const catSelect = document.getElementById('admProdCatSelect');

    if(!fileInput.files[0] || !nameInput.value || !priceInput.value) {
        return alert("ูุฑุฌู ุฅููุงู ุจูุงูุงุช ุงูููุชุฌ ูุงุฎุชูุงุฑ ุงูุตูุฑุฉ");
    }

    alert("ุฌุงุฑู ุฑูุน ุตูุฑุฉ ุงูููุชุฌ...");

    try {
        const imageUrl = await uploadImg(fileInput.files[0]);
        db.ref('products').push({
            category: catSelect.value,
            name: nameInput.value,
            price: priceInput.value,
            img: imageUrl
        }).then(() => {
            alert("ุชู ูุดุฑ ุงูููุชุฌ ุจูุฌุงุญ!");
            location.reload();
        });
    } catch (error) {
        alert("ูุดู ุฑูุน ุตูุฑุฉ ุงูููุชุฌ");
    }
}  </script>
  
</body>
</html>
